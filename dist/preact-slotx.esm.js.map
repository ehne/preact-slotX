{"version":3,"file":"preact-slotx.esm.js","sources":["../src/index.js"],"sourcesContent":["import {createContext, html, useState, useMemo, useEffect} from \"htm/preact\"\n\n\nconst SlotsContext = createContext({\n    named: {},\n    changed: []\n})\n\n/*\n    {\n        named:{\n            \"foo\":Component\n        },\n        changed:[\"foo\"]\n    }\n*/\n\nexport function Slot({name, children}) {\n    const context = useContext(SlotsContext);\n    const [content, setContent] = useState(children)\n\n    // only run this code if the the \"changed\" array has changed in regards to the name.\n    // note: this will run twice, once when name is added, and once when it is removed. (because the array changed both times)\n    useEffect(()=>{\n        \n        setContent(context.named[name])\n\n        // cleanup function, removes name from the array so we can change it later.\n        return () => {\n            context.changed = context.changed.filter((val)=>(val!=name))\n            console.log(context)\n        }\n        \n    }, [context.changed.filter((val)=>(val===name))])\n\n    // checks if there is no SlotContent component defined for the specific name.\n    if (context.named[name] === undefined) {\n        return children\n    } else {\n        return content\n\n    }\n} \n\n\nexport function SlotContent({name,children}) {\n    const context = useContext(SlotsContext)\n\n    // defines the component\n    context.named[name] = children\n    // runs this code when the children change.\n    useMemo(() => {\n        // set slot value\n        context.named[name] = children\n        // add name to array so that Slot knows to update\n        context.changed.push(name)\n    }, [children]);\n\n    //console.log(context)\n    return null\n}\n\nexport function SlotProvider({children}) {\n    const [named, setNamed] = useState({});\n    const [changed, setChanged] = useState([]);\n    \n    return html`<${SlotsContext.Provider} value=${ {\n        named, changed\n    } }>\n        ${children}\n    <//>\n    `\n}"],"names":["SlotsContext","createContext","named","changed","Slot","name","children","context","useContext","useState","content","setContent","useEffect","filter","val","console","log","undefined","SlotContent","useMemo","push","SlotProvider","html","Provider"],"mappings":"uOAGA,IAAMA,EAAeC,EAAc,CAC/BC,MAAO,GACPC,QAAS,cAYGC,SAAMC,IAAAA,KAAMC,IAAAA,SAClBC,EAAUC,WAAWR,KACGS,EAASH,GAAhCI,OAASC,OAiBhB,OAbAC,EAAU,WAKN,OAHAD,EAAWJ,EAAQL,MAAMG,eAIrBE,EAAQJ,QAAUI,EAAQJ,QAAQU,OAAO,SAACC,UAAOA,GAAKT,IACtDU,QAAQC,IAAIT,KAGjB,CAACA,EAAQJ,QAAQU,OAAO,SAACC,UAAOA,IAAMT,WAGbY,IAAxBV,EAAQL,MAAMG,GACPC,EAEAI,WAMCQ,SAAab,IAAAA,KAAKC,IAAAA,SACxBC,EAAUC,WAAWR,GAa3B,OAVAO,EAAQL,MAAMG,GAAQC,EAEtBa,EAAQ,WAEJZ,EAAQL,MAAMG,GAAQC,EAEtBC,EAAQJ,QAAQiB,KAAKf,IACtB,CAACC,kBAMQe,SAAcf,IAAAA,SACnBJ,EAAmBO,EAAS,OAC5BN,EAAuBM,EAAS,OAEvC,OAAOa,MAAQtB,EAAauB,SAAmB,CAC3CrB,MAAAA,EAAOC,QAAAA,GAELG"}